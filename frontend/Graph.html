<!DOCTYPE html>
<html style="font-size: 16px;">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="COVID AROUND THE WORLD​​">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Graph | Covid Around The World</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
    <link rel="stylesheet" href="Graph.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 3.0.9, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto+Slab:100,300,400,700">


    <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "",
        "url": "index.html",
        "logo": "images/53e0dd454f56a814f6da8c7dda793678153bdee757596c48732f7ddc9e4ec65abf_1280.png"
    }</script>
    <meta property="og:title" content="Graph">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#478ac9">
    <link rel="canonical" href="index.html">
    <meta property="og:url" content="index.html">

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</head>

<body class="u-body">
<header class="u-clearfix u-header u-header" id="sec-6a2c">
    <div class="u-clearfix u-sheet u-sheet-1">
        <a href="https://nicepage.com" class="u-image u-logo u-image-1" data-image-width="1278"
           data-image-height="1280">
            <img src="images/53e0dd454f56a814f6da8c7dda793678153bdee757596c48732f7ddc9e4ec65abf_1280.png"
                 class="u-logo-image u-logo-image-1" data-image-width="64">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
            <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
                <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                   href="#">
                    <svg>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
                    </svg>
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <defs>
                            <symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;">
                                <rect y="1" width="16" height="2"></rect>
                                <rect y="7" width="16" height="2"></rect>
                                <rect y="13" width="16" height="2"></rect>
                            </symbol>
                        </defs>
                    </svg>
                </a>
            </div>
            <div class="u-nav-container">
                <ul class="u-nav u-unstyled u-nav-1">
                    <li class="u-nav-item"><a
                            class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                            href="Home-Page.html" style="padding: 10px 20px;">Home Page</a>
                    </li>
                    <li class="u-nav-item"><a
                            class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                            href="Map.html" style="padding: 10px 20px;">Map</a>
                    </li>
                    <li class="u-nav-item"><a
                            class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                            href="Graph.html" style="padding: 10px 20px;">Graph</a>
                    </li>
                    <li class="u-nav-item"><a
                            class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                            href="BubbleChart.html" style="padding: 10px 20px;">Bubble Chart</a>
                    </li>
                </ul>
            </div>
            <div class="u-nav-container-collapse">
                <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                    <div class="u-sidenav-overflow">
                        <div class="u-menu-close"></div>
                        <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                            <li class="u-nav-item"><a class="u-button-style u-nav-link" href="Home-Page.html">Home
                                Page</a>
                            </li>
                            <li class="u-nav-item"><a class="u-button-style u-nav-link" href="Map.html">Map</a>
                            </li>
                            <li class="u-nav-item"><a class="u-button-style u-nav-link" href="Graph.html">Graph</a>
                            </li>
                            <li class="u-nav-item"><a class="u-button-style u-nav-link" href="BubbleChart.html">Bubble Chart</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
            </div>
        </nav>
        <h1 class="u-custom-font u-font-roboto-slab u-text u-text-default u-title u-text-1">COVID AROUND THE WORLD <span
                style="font-size: 1.875rem;"></span>
        </h1>
    </div>
</header>
<section class="u-clearfix u-palette-3-light-3 u-section-1" id="sec-1a8a">
    <div class="u-clearfix u-sheet u-sheet-1">
        <h1 class="u-align-center u-custom-font u-font-roboto-slab u-text u-title u-text-1">Covid-19 and Currency
            Graph</h1>
        <div class="u-form u-form-1" id="app">

            <form method="POST" class="u-clearfix u-form-horizontal u-form-spacing-15 u-inner-form"
                  style="padding: 15px;" source="custom">
                <div class="u-form-group u-form-name">
                    <label for="name-ef64" class="u-form-control-hidden u-label">Name</label>
                    <input type="text" placeholder="Enter Country" id="name-ef64" name="name"
                           class="u-border-1 u-border-grey-30 u-input u-input-rectangle u-white u-input-1" required="">
                </div>
                <div class="u-form-group u-form-submit">
                    <a href="#" class="u-btn u-btn-submit u-button-style">SEARCH</a>
                    <input type="submit" value="submit" class="u-form-control-hidden">
                </div>
                <!-- <div class="u-form-send-message u-form-send-success">#FormSendSuccess</div>
                <div class="u-form-send-error u-form-send-message">SEARCHING FOR THAILAND</div> -->
                <input type="hidden" value="" name="recaptchaResponse">
            </form>

        </div>
        <h2 class="u-custom-font u-font-roboto-slab u-text u-text-2"></h2>
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
            <div class="u-layout">
                <div class="u-layout-row">
                  <div class="u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                    <div class="u-container-layout u-container-layout-1">
                        <div id="myDiv" style="width:550px;height:250px;"></div>
                    </div>
                  </div>
                  <div class="u-container-style u-layout-cell u-size-30 u-layout-cell-2">
                    <div class="u-container-layout u-container-layout-2">
                        <div id="myDiv2" style="width:550px;height:250px;"></div>
                    </div>
                  </div>
                </div>
              </div>
        </div>
        <a href="Home-Page.html" data-page-id="89520485"
           class="u-btn u-btn-round u-button-style u-hover-palette-1-light-1 u-palette-1-base u-radius-50 u-btn-2">HOME
            PAGE</a>
    </div>
</section>


<footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-50e7">
    <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-custom-font u-font-roboto-slab u-text u-text-default u-text-1"><b>DAQ Project:
            Covid19AroundTheWorld</b>
        </p>
        <div class="u-border-6 u-border-white u-line u-line-horizontal u-line-1"></div>
    </div>
</footer>
<section class="u-backlink u-clearfix u-grey-80">
    <a class="u-link" href="https://nicepage.com/html-templates" target="_blank">
        <span>Free HTML Templates</span>
    </a>
    <p class="u-text">
        <span>created with</span>
    </p>
    <a class="u-link" href="https://nicepage.com/" target="_blank">
        <span>Website Builder Software</span>
    </a>
  </section>
  <script type="text/javascript" src="Graph.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  
<script>

    $(document).ready(async function () {
        $('form').submit(async function (e) {
            e.preventDefault();

            var cname = $('#name-ef64').val();
            const cnameCap = cname.charAt(0).toUpperCase() + cname.slice(1)

            createNewCasesChart(cnameCap);
            createCurrencyChart(cnameCap);


        })
    });

async function createNewCasesChart(input) {

    var resp = await fetch('http://localhost:3000/graphql', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
        },
        body: JSON.stringify({
            query: `{
        covid19SituationNewCase(countryName: "${input}") {
        countryId
        countryName
        date
        newCases
        newDeath
    } 
    }`
            })
        });
    var json = await resp.json();
    var table = json.data;
    var config = {responsive: true};


    var dataNewDeaths = {
        x: [],
        y: [],
        mode: 'lines',
        type: 'line',
        name:'New Deaths'
    }
    var dataNewCases = {
        x: [],
        y: [],
        mode: 'lines',
        type: 'line',
        name:'New Cases'
    }

    table.covid19SituationNewCase.forEach((el) => {
        dataNewCases.x.push(el.date)
        dataNewCases.y.push(el.newCases)
    })

    table.covid19SituationNewCase.forEach((el) => {
        dataNewDeaths.x.push(el.date)
        dataNewDeaths.y.push(el.newDeath)

    })

    var layout_situation = {
        title: 'Situation of Covid-19 in ' + input,
        xaxis: {
            title: 'Date'
        },
        yaxis: {
            title: 'New Cases',
            range: [0, Math.max(dataNewCases.y)]
        }
    };
    
    var all = [dataNewCases,dataNewDeaths]
    Plotly.newPlot('myDiv', all,layout_situation, config);
    }

    async function createCurrencyChart(input) {

        var resp = await fetch('http://localhost:3000/graphql', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
            },
            body: JSON.stringify({
                query: `
    {
        currencyRatesDetail(countryName: "${input}") {
    countryId
    countryName
    currencyRates
    currencyUnit
    date
    }
   }`
            })
        });
        var dataNewCurrencies = [{
        x: [],
        y: [],
        mode: 'lines',
        type: 'line',
        name:'dataNewCurrencies'
    }]
        var json = await resp.json();
        var table = json.data;
        var config = {responsive: true};
        table.currencyRatesDetail.forEach((el) => {
            dataNewCurrencies[0].x.push(el.date)
            dataNewCurrencies[0].y.push(el.currencyRates)

        })

        var layout = {
            title: 'Currency Rates in ' + input,
            xaxis: {
                title: 'Date'
            },
            yaxis: {
                title: 'Currency Rates (Per Euro €)',
                range: [0, Math.max(dataNewCurrencies[0].y)]
            }

        };

        Plotly.newPlot('myDiv2', dataNewCurrencies, layout, config);
    }      


</script>

</body>

</html>